local locations = 
{
    rulebookLoc = {-54.06, 0.97, -50.58},
    rulebookRot = {0.00, 180.0, 0.00},

    rulebookAids = 
    {
        rulebookAid1Loc = {-60.28, 0.97, 23.94},
        rulebookAid2Loc = {-54.59, 0.97, 23.97},
        rulebookAid3Loc = {-48.94, 0.97, 24.06},
        rulebookAid4Loc = {-43.15, 0.97, 24.02},
        rulebookAid5Loc = {-37.46, 0.97, 24.02},
        rulebookAid6Loc = {-60.26, 0.97, 15.76},
        rulebookAid7Loc = {-54.62, 0.97, 15.84},
        rulebookAid8Loc = {-48.98, 0.97, 15.84},
        rulebookAid9Loc = {-43.27, 0.97, 15.85},
        rulebookAid10Loc = {-37.56, 0.97, 15.82}
    },
    rulebookAidRot = {0.00, 180.03, 0.00},

    oxygenTokenLoc = {{-22.25, 1.04, -21.33},{-6.02, 1.04, -21.42},{10.40, 1.04, -21.34},{24.88, 1.04, -21.61}},
    oxygenTokenRot = {0.00, 180.0, 0.0},
    oxygenCubesBagLoc = {11.55, 0.97, 6.87},
    oxygenCubesBagRot = {0.00, 0.00, 0.00},

    oxygenCubeLocs = {{-22.23, 1.28, -21.01},{-22.24, 1.28, -21.40},{-22.23, 1.28, -21.77},{-22.24, 1.28, -22.17},
                    {-6.00, 1.28, -21.10},{-6.01, 1.28, -21.48},{-6.01, 1.28, -21.86},{-6.01, 1.28, -22.26},
                    {10.43, 1.28, -21.02},{10.41, 1.28, -21.41},{10.42, 1.28, -21.78},{10.41, 1.28, -22.18},
                    {24.90, 1.28, -21.29},{24.89, 1.28, -21.68},{24.90, 1.28, -22.05},{24.89, 1.28, -22.45}},

    upgradeBoardGunnerLoc = {-24.20, 1.12, -17.71},
    upgradeBoardScoutLoc = {-8.76, 1.07, -17.69},
    upgradeBoardDrillerLoc = {6.60, 1.07, -17.69},
    upgradeBoardEngineerLoc = {21.98, 1.11, -17.70},
    upgradeBoardRot = {0.0, 90.0, 0.0},

    spaceRigBoardLoc = {-43.44, 1.07, 1.15},
    spaceRigBoardRot = {0.00, 180.0, 0.00},

    trackerCube1Loc = {-48.17, 1.41, -2.41},
    trackerCube1Rot = {0.00, 0.0, 180.00},
    trackerCube2Loc = {-42.81, 1.51, 0.53},
    trackerCube2Rot = {0.00, 0.0, 180.00},

    memorialStatueLoc = {-46.87, 1.16, 0.89},
    memorialStatueRot = {0.00, 209.98, 0.00},

    challengeDeckLoc = {-46.00, 2.0, 3.84},
    challengeDeckRot = {0.00, 180.00, 180.00},

    beerDeckLoc = {-38.03, 2.0, 3.50},
    beerDeckRot = {0.00, 180.0, 180.00}, 

    stickerExterminators = {-54.99, 1.04, 4.01},
    stickerSuperProtector = {-53.89, 1.05, 4.01},
    stickerUpClose = {-52.79, 1.04, 4.01},
    stickerBreathtaking = {-51.69, 1.04, 4.01},
    stickerHardboiled = {-55.54, 1.05, 3.06},
    stickerHoarders = {-54.44, 1.05, 3.06},
    stickerRoughnecks = {-53.34, 1.05, 3.06},
    stickerVeteranDwarves = {-52.24, 1.04, 3.06},
    stickerRot = {0.0, 180.0, 0.0}, 

    missionModRedLoc = {-34.65, 0.97, 1.15},
    missionModRedRot = {0.0,0.0,0.0},
    missionModYellowLoc = {-34.65, 0.97, -0.75},
    missionModYellowRot = {0.00, 180.00, 0.00},

    upgradesHUDBagLoc = {-54.44, 0.97, 1.15},
    upgradesArmourBagLoc = {-53.34, 0.97, 1.15},
    upgradesPickaxeBagLoc = {0.00, 0.87, 0.00},
    upgradesRot = {0.00, 180.00, 0.00},

    pickupShuffleBagLoc = {12.10, 0.97, -7.42},
    pickupAbandonedGearBagLoc = {13.20, 0.97, -7.42},
    pickupGoldBugBagLoc = {14.30, 0.97, -7.42},
    pickupMaltSaltBagLoc = {15.40, 0.97, -7.42},
    pickupYeastBagLoc = {16.50, 0.97, -7.42},
    pickupRot = {0.0,0.0,0.0},

    pumpjackBagLoc = {-14.85, 0.96, 3.06},
    pumpjackBagRot = {0.00, 180.00, 0.00},
    pipeStraightBagLoc = {-14.85, 0.97, 1.15},
    pipeStraightBagRot = {0.0,0.0,0.0},
    pipeCurvedBagLoc = {-14.85, 0.97, -0.75},
    pipeCurvedBagRot = {0.00, 240.00, 0.00},

    drilldozerLoc = {-24.75, 0.97, 1.15},
    drilldozerRot = {0.00, 270.0, 0.00},
    drilldozerTokenLoc = {-22.00, 1.05, -1.70},
    drilldozerTokenRot = {0.00, 180.0, 0.00},

    refineryLoc = {-15.95, 1.11, -2.66},
    refineryRot = {0.00, 300.00, 180.00},

    beamerBagLoc = {-19.25, 0.96, 1.15},
    beamerBagRot = {0.00, 90.00, 0.00},

    heartstoneLoc = {-21.45, 0.97, 1.15},
    heartstoneRot = {0.00, 239.96, 0.00},
    heartstoneGemLoc = {-21.41, 1.37, 1.28},
    hearstoneGemRot = {50.92, 83.33, 192.57},

    miniHiddenCavesBagLoc = {16.50, 0.95, 0.20},
    miniHiddenCavesBagRot = {0.00, 60.00, 0.00},
}

local GUIDs =
{
    rulebook = '768854',

    rulebookAids = 
    {
        rulebookAid1 = 'c931f7',
        rulebookAid2 = '249ea6',
        rulebookAid3 = 'b49b2f',
        rulebookAid4 = '19b926',
        rulebookAid5 = '2d0564',
        rulebookAid6 = '596fb7',
        rulebookAid7 = '2f31fd',
        rulebookAid8 = '945a76',
        rulebookAid9 = '17cd74',
        rulebookAid10 = 'd4ff36'
    },

    oxygenTokens = {'9ba832','d75777','7b5043','23f2a0'},
    oxygenCubesBag = 'd0b7aa',

    upgradeBoardGunner = '8a4b95',
    upgradeBoardScout = '89eadd',
    upgradeBoardDriller = '1f888c',
    upgradeBoardEngineer = 'fd11cf',

    spaceRigBoard = '6f0b82',
    memorialStatue = '52fc48',
    trackerCube1 = '290dc9',
    trackerCube2 = '833ce7',

    stickerExterminators = 'b1d92f',
    stickerSuperProtector = '1e1671',
    stickerUpClose = 'e9b53e',
    stickerBreathtaking = '4db170',
    stickerHardboiled = 'c6226c',
    stickerHoarders = '3398c9',
    stickerRoughnecks = 'f3c70c',
    stickerVeteranDwarves = '7ed6db',

    missionModRedBag = '5ed9dd',
    missionModYellowBag = 'b1377f',

    upgradesHUDBag = 'f1904b',
    upgradesArmourBag = '30b4e1',
    upgradesPickaxeBag = '074163',

    pickupShuffleBag = '1f2255',
    pickupAbandonedGearBag = '9455c7',
    pickupGoldBugBag = '3ebf97',
    pickupMaltSaltBag = '6ff8d3',
    pickupYeastBag = 'e22bb0',

    pumpjackBag = '845be5',
    pipeStraightBag = '8d3753',
    pipeCurvedBag = 'a52a6d',

    drilldozer = '8887ac',
    drilldozerToken = 'cdd78c',

    refinery = '1d5b9a',

    beamerBag = '3d4ec3',
    heartstoneClosed = '64c2ff',
    hearstoneOpen = 'd84756',
    hearstoneGem = 'c0ab17',

    miniHiddenCaveBag = '3cff09',

    cards = 
    {
        secondaries =
        {
            scopedSubata = '92a6b2',
            stubbyExplosive = '8251b1',
        },

        rockAndStone = 
        {
            betterEquipment = 'ffb477',
            bottomsUp = '41302c',
        }
    }
}

function onLoad()
    self.clearButtons()

    if Global.call('getSpaceRigExpansionToggle') then
        ShowDisableExpansionButton()
    else
        ShowEnableExpansionButton()
    end

    expansionBox = getObjectFromGUID(GUIDs.expansionBox)
end

function ShowEnableExpansionButton()
    self.clearButtons()

    self.createButton(
        {
            click_function='ConfirmSetupButton',
            function_owner=self,
            label="Enable\n Expansion",
            position={0.0,1.0,-5.0},
            rotation={0.0,0.0, 0.0},
            width=1100*1.5,
            height=360*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Green',
            tooltip='Enable Space Rig Expansion'
        }
    )
end

function ShowDisableExpansionButton()
    self.clearButtons()

    self.createButton(
        {
            click_function='ConfirmCleanupButton',
            function_owner=self,
            label="Disable\n Expansion",
            position={0.0,1.0,-5.0},
            rotation={0.0,0.0, 0.0},
            width=1100*1.5,
            height=360*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Red',
            tooltip='Disable Space Rig Expansion'
        }
    )
end

function ConfirmSetupButton()
    self.createButton(
        {
            click_function='EnableExpansion',
            function_owner=self,
            label="Yes",
            position={-1.0,1.0,-3.7},
            rotation={0.0,0.0, 0.0},
            width=500*1.5,
            height=350*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Green',
            tooltip='Yes - Continue Setup'
        }
    )

    self.createButton(
        {
            click_function='ShowEnableExpansionButton',
            function_owner=self,
            label="No",
            position={1.0,1.0,-3.7},
            rotation={0.0,0.0, 0.0},
            width=500*1.5,
            height=350*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Red',
            tooltip='No - Cancel Setup'
        }
    )
end

function ConfirmCleanupButton()
    self.createButton(
        {
            click_function='DisableExpansion',
            function_owner=self,
            label="Yes",
            position={-1.0,1.0,-3.7},
            rotation={0.0,0.0, 0.0},
            width=500*1.5,
            height=350*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Green',
            tooltip='Yes - Continue Cleanup'
        }
    )

    self.createButton(
        {
            click_function='ShowDisableExpansionButton',
            function_owner=self,
            label="No",
            position={1.0,1.0,-3.7},
            rotation={0.0,0.0, 0.0},
            width=500*1.5,
            height=350*1.5,
            font_size=150*1.5,
            font_color='White',
            color='Red',
            tooltip='No - Cancel Cleanup'
        }
    )
end

function EnableExpansion()
    self.clearButtons()

    Wait.time(function()
        ShowDisableExpansionButton()
    end,2)

    -- Checks if there are players minis in the cleanup zone (on a mission)
    if (Global.Call('getMissionCleanupScript').Call('CheckForPlayersInCleanupZone')) then
        printToAll('Unable to set up: Space Rig Expansion', 'Red')
        printToAll('Mission in progress detected, cleanup mission before enabling expansion\n', 'Red')
        return
    end

    printToAll('Setting up: Space Rig Expansion', 'Yellow')

    Global.Call('setSpaceRigExpansionToggle',true)

    -- Rulebook setup
    params={
        bag = expansionBox,
        ID = GUIDs.rulebook,
    }
    if Global.call('isInBag',params) then
        params.bag.takeObject({
            position = locations.rulebookLoc,
            rotation = locations.rulebookRot,
            guid = params.ID
        })
    else
        printToAll("Warning: Unable to set up Space Rig Rulebook, it's not in the expansion box", 'Red')
    end

    -- Rulebook aids
    for i = 1, #locations.rulebookAids do
        params={
            bag = expansionBox,
            ID = GUIDs.locations.rulebookAids[i],
        }
        if Global.call('isInBag',params) then
            params.bag.takeObject({
                position = locations.rulebookAids[i],
                rotation = locations.rulebookAidRot,
                guid = params.ID
            })
        else
            printToAll("Warning: Unable to set up Space Rig Rulebook Aids, it's not in the expansion box", 'Red')
        end
    end

    -- Oxygen token setup
    for i = 1, 4 do
        params={
            bag = expansionBox,
            ID = GUIDs.locations.oxygenTokens,
        }
        if Global.call('isInBag',params) then
            params.bag.takeObject({
                position = locations.oxygenTokenLoc[i],
                rotation = locations.oxygenTokenRot,
                guid = params.ID
            })
        else
            printToAll("Warning: Unable to set up Oxygen Tokens, it's not in the expansion box", 'Red')
        end
    end

    -- Oxygen Cubes Bag
    params={
        bag = expansionBox,
        ID = GUIDs.oxygenCubesBag,
    }
    if Global.call('isInBag',params) then
        oxygenBag = params.bag.takeObject({
            position = locations.oxygenCubesBagLoc,
            rotation = locations.oxygenCubesBagRot,
            guid = params.ID
        })

        for i = 1, 16 do
            oxygenBag.takeObject({
                position = locations.oxygenCubeLocs[i]
            })
        end
    else
        printToAll("Warning: Unable to set up Oxygen Cube Bag, it's not in the expansion box", 'Red')
    end
end